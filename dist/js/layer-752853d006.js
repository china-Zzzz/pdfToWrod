"use strict";function setParam(e){var e=Base64.decode(JSON.stringify(GetQueryString("json"))),o=JSON.parse(e);"1"===o.type?_template(o.option):"2"===o.type?_progressTem(o.option):"3"===o.type?_paymentTem(o.option):"4"===o.type?_passwordTem(o.option):_pagesTem(o.option)}function _template(e){var o=$("#template").html(),t=Handlebars.compile(o),n=t(e);$("#body").html(n),_css(),_off(),_event()}function _passwordTem(e){var o=$("#password").html(),t=Handlebars.compile(o),n=t(e);$("#body").html(n),_css(),_off(),_event()}function _progressTem(e){var o=$("#progress").html(),t=Handlebars.compile(o),n=t(e);$("#body").html(n),_css(),_off(),_event()}function _pagesTem(e){var o=$("#pages").html(),t=Handlebars.compile(o),n=t(e),a=e.pages[1];$("#body").html(n),_css(),_off(),_event();var s=parseInt($("#end").val());$("#begin").bind("propertychange input",function(e){var o=parseInt($("#end").val()),t=parseInt($(e.target).val());t>o||0===t||isNaN(t)||isNaN(o)||o>s||o>a?(0===t&&$(e.target).val(""),$(".pages").css({background:"#98a0b4",border:"1px solid #98a0b4"}),$(".maks").removeClass("none")):($(".pages").css({background:"#F98953",border:"1px solid #F98953"}),$(".maks").addClass("none"))}),$("#end").bind("propertychange input",function(e){var o=parseInt($(e.target).val()),t=parseInt($("#begin").val());t>o||0===o||isNaN(o)||o>a||o>s||isNaN(t)?(0===o&&$(e.target).val(""),$(".pages").css({background:"#98a0b4",border:"1px solid #98a0b4"}),$(".maks").removeClass("none")):($(".pages").css({background:"#F98953",border:"1px solid #F98953"}),$(".maks").addClass("none"))})}function SetProgress(e){if("100"!==e)$("#pro").css("width",e+"%");else{var o={type:"2",option:{isProgress:!0,isScroll:!1,data:{title:"检查更新",text:["下载成功，请点击“立即安装”"],progress:{color:"color:#efa075"},button:[{text:"立即安装","background-color":"ok",type:"update"}]}}};_progressTem(o.option),$(".am-progress-b").css("width","100%")}}function _paymentTem(e){var o=$("#payment").html(),t=Handlebars.compile(o),n=t(e);$("body").html(n),_css(),_off(),_event()}function GetQueryString(e){var o=new RegExp("(^|&)"+e+"=([^&]*)(&|$)"),t=window.location.search.substr(1).match(o);return null!=t?unescape(t[2]):null}function _css(){var e=$(".footer-button").find(".button").length,o=$(".section-p").find("p").length,t=$(".footer-button").find(".button").outerWidth(),n=$(".top").outerWidth();$(".section-p").outerHeight();$(".footer-button").width(t*e+20),$("footer").css("margin-left",-((t*e+20)/2)-10),$(".top").css("margin-left",-(n/2)),$(".top").css("left","50%"),1===e&&"Microsoft Internet Explorer"==navigator.appName&&"MSIE7.0"==navigator.appVersion.split(";")[1].replace(/[ ]/g,"")&&$("footer").css("margin-left",-((t*e+20)/2)-55),1===o?($(".section-p").css("margin-top","11px"),$("footer").css("bottom","42px")):2===o?$(".section-p").css("margin-top","4px"):3===o&&$(".section-p").css("margin-top","0px")}function _event(){$(".delete").on("mousedown",function(e){try{window.external.Close()}catch(o){}}),$(".found").on("mousedown",function(e){try{window.external.DeskTopIcon()}catch(o){}}),$(".fivePage").on("mousedown",function(e){try{window.external.DeskTopIcon()}catch(o){}}),$(".update").on("mousedown",function(e){try{window.external.Update()}catch(o){}}),$(".payment").on("mousedown",function(e){try{window.external.Pay()}catch(o){}}),$(".password").on("mousedown",function(e){var o=$(".password-input").find("input").val();try{var t=window.external.SetPassword(o);"false"===t&&$(".password-input span").removeClass("none")}catch(n){}}),$(".land").on("mousedown",function(e){try{window.external.Login()}catch(o){}}),$(".pages").on("mousedown",function(e){var o=$("#begin").val()+"-"+$("#end").val();try{window.external.SetConvertPage(o)}catch(t){}})}function _off(){$(".delete").off(),$(".found").off(),$(".update").off(),$(".payment").off(),$(".password").off(),$(".land").off()}setParam();